{
  "db": "PostgreSQL",
  "396f5c537d776c251d45fe435188ccd68a8567497693eacae40fa73fc1efa844": {
    "describe": {
      "columns": [
        {
          "name": "subscription_id",
          "ordinal": 0,
          "type_info": "Int4"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Text",
          "Text"
        ]
      }
    },
    "query": "SELECT subscription_id FROM subscriptions WHERE kind = 'discord_stream_update' AND (payload ->> 'channel_id') = $1 AND (payload ->> 'guild_id') = $2 AND (payload ->> 'vtuber_id') = $3"
  },
  "3e2c42646bfc82c0ab3033100569ee0ed5d01461f773c3a50a164e152ea0fec4": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4",
          "Timestamptz",
          "Int4"
        ]
      }
    },
    "query": "\nINSERT INTO stream_viewer_stats AS s (stream_id, time, count)\n     VALUES ($1, $2, $3)\nON CONFLICT (stream_id, time) DO UPDATE\n        SET count = GREATEST(excluded.count, s.count)\n            "
  },
  "40351d476b955b723664c1a8104225e75021678d79c2e0fca0009c66d26bef73": {
    "describe": {
      "columns": [
        {
          "name": "vtuber_id",
          "ordinal": 0,
          "type_info": "Text"
        },
        {
          "name": "status: _",
          "ordinal": 1,
          "type_info": {
            "Custom": {
              "kind": {
                "Enum": [
                  "scheduled",
                  "live",
                  "ended"
                ]
              },
              "name": "stream_status"
            }
          }
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "SELECT c.vtuber_id, s.status as \"status: _\" from streams s LEFT JOIN channels c ON s.channel_id = c.channel_id WHERE s.stream_id = $1"
  },
  "554a1f77e3cb25e634b91c04049fffd3b6fdc423373223d0b2b29d29e4b24124": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Text",
          "Timestamptz",
          "Int4",
          "Int4"
        ]
      }
    },
    "query": "\n UPDATE streams\n    SET title      = COALESCE($1, title),\n        updated_at = NOW(),\n        start_time = COALESCE(start_time, $2),\n        status     = 'live',\n        like_max   = GREATEST($3, like_max)\n  WHERE stream_id  = $4\n        "
  },
  "6295b23270900cba32ec653e47d2bb36eb2e21a8480842c7adca896093817445": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "DELETE FROM notifications WHERE subscription_id = $1"
  },
  "69e811bb6b79d1ff397a044a2b5d4c1035b1482a5a24198a56107ac36b273bb8": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "DELETE FROM subscriptions WHERE subscription_id = $1"
  },
  "725e5036f434538e9413a7aad06ae6601ec557fb84e66f0614626c1ff3b4dee2": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4",
          "Int4",
          "Timestamptz"
        ]
      }
    },
    "query": "\n     UPDATE streams\n        SET viewer_max = GREATEST(viewer_max, $1),\n            viewer_avg = (SELECT AVG(count) FROM stream_viewer_stats WHERE stream_id = $2),\n            updated_at = $3\n      WHERE stream_id = $2\n            "
  },
  "74bab5728e6602040e7d103ed51f0da94315a0bd15de9545471f8c40e5665d6b": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Text",
          "Text",
          "Text",
          "Text",
          "Text",
          "Text"
        ]
      }
    },
    "query": "INSERT INTO vtubers (vtuber_id, native_name, english_name, japanese_name, twitter_username, thumbnail_url)\n            VALUES ($1, $2, $3, $4, $5, $6)"
  },
  "852a2d5f520961ec9094bcbf585fd361cf9dbaf6b7dc86f2b71ae5398482f56b": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "DELETE from streams WHERE stream_id = $1"
  },
  "a776980e570e14df4951d06bb67971cda011091236bb9449bf16db5f70288391": {
    "describe": {
      "columns": [
        {
          "name": "count",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        null
      ],
      "parameters": {
        "Left": [
          "Text"
        ]
      }
    },
    "query": "SELECT COUNT(*) FROM vtubers WHERE vtuber_id = $1"
  },
  "ad7b071f04921216253c2c5e41a6fabf96a654df4fb1a54c18815ee483ca603e": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "UPDATE jobs SET status = 'queued', last_run = NOW(), updated_at = NOW() WHERE job_id = $1"
  },
  "ddbd3758f963833db871cb0a37f45e27756e52e6345c130be89528910bc0b03c": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "UPDATE streams SET status = 'ended', end_time = NOW() WHERE stream_id = $1"
  },
  "faa15d2c0d8e70002982fe6383c133fca6e6b90cdad3424ce0940361cbce35d9": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Int4"
        ]
      }
    },
    "query": "UPDATE notifications SET updated_at = NOW() WHERE notification_id = $1"
  },
  "fdf21e03877a848e0a282fd3c4ca864be83ca5aaa68c60384bc9f79b62b8aaf8": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Text",
          "Timestamptz",
          "Timestamptz",
          "Timestamptz",
          "Int4",
          "Int4"
        ]
      }
    },
    "query": "\n UPDATE streams\n    SET status        = 'ended',\n        title         = COALESCE($1, title),\n        end_time      = COALESCE($2, end_time),\n        start_time    = COALESCE($3, start_time),\n        schedule_time = COALESCE($4, schedule_time),\n        like_max      = GREATEST($5, like_max),\n        updated_at    = NOW()\n  WHERE stream_id     = $6\n        "
  }
}